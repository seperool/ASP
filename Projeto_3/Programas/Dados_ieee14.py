# Bibliotecas
import pandas as pd
import numpy as np
import cmath

# Base de Potência (necessária para conversão subsequente)
S_base = 100 # MVA

# Dados de Barras (DF_BARRAS)
dados_barra = {
    'Cod': ['L2', 'L1', 'L1', 'L', 'L', 'L1', 'L', 'L1', 'L', 'L', 'L', 'L', 'L', 'L'],
    'Tipo': ['SLACK', 'PV', 'PV', 'PQ', 'PQ', 'PV', 'PQ', 'PV', 'PQ', 'PQ', 'PQ', 'PQ', 'PQ', 'PQ'],
    'V': [1000.000, 1000.000, 1000.000, 956.000, 958.000, 1000.000, 984.000, 1000.000, 979.000, 975.000, 984.000, 984.000, 978.000, 959.000],
    'A': [0.230, -5.700, -15.000, -12.000, -9.900, -16.000, -15.000, -15.000, -17.000, -17.000, -17.000, -17.000, -17.000, -18.000],
    'Pg': [4.100, 40.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000],
    'Qg': [-21.100, 50.000, 40.000, 0.000, 0.000, 14.160, 0.000, 8.910, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000],
    'Qn': [-9999.000, -40.000, 0.000, 0.000, 0.000, -6.000, 0.000, -6.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000],
    'Qm': [500.000, 80.000, 70.000, 0.000, 0.000, 40.000, 0.000, 40.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000],
    'Pl': [0.000, 21.700, 94.200, 47.800, 7.600, 11.200, 0.000, 0.000, 29.500, 9.000, 3.500, 6.100, 13.500, 14.900],
    'Ql': [0.000, 12.700, 19.000, -3.900, 1.600, 7.500, 0.000, 0.000, 16.600, 5.800, 1.800, 1.600, 5.800, 5.000],
    'Bc': [0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 19.000, 0.000, 0.000, 0.000, 0.000, 0.000],
    'Vf': [11000, 11000, 11000, 11000, 11000, 11000, 11000, 11000, 11000, 11000, 11000, 11000, 11000, 11000]
}

# Criação do DataFrame com o número da barra como índice
df_barras = pd.DataFrame(dados_barra, index=range(1, 15))
df_barras.index.name = 'Num'

#print(df_barras)

# Dados de Circuitos (DLIN) – Dados Brutos
dados_circuito = {
    'De': [1, 1, 2, 2, 2, 3, 4, 4, 4, 5, 6, 6, 6, 7, 7, 9, 9, 10, 12, 13],
    'Para': [2, 5, 3, 4, 5, 4, 5, 7, 9, 6, 11, 12, 13, 8, 9, 10, 14, 11, 13, 14],
    'NcEP': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
    'R%': [1.938, 5.403, 4.699, 5.811, 5.695, 6.701, 1.335, 0.000, 0.000, 0.000, 9.498, 12.291, 6.615, 0.000, 0.000, 3.181, 12.711, 8.205, 22.092, 17.093],
    'X%': [5.917, 22.304, 19.797, 17.632, 17.388, 17.103, 4.211, 20.912, 55.618, 25.202, 19.890, 25.581, 13.027, 17.615, 11.001, 8.450, 27.038, 19.207, 19.988, 34.802],
    'Bsh/2_Mvar': [5.28, 4.92, 4.38, 3.74, 3.40, 3.46, 1.28, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00],
    'Tap': [1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 0.978, 0.969, 0.932, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000],
    'Tmn': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    'Tmx': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    'Phs': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    'Bc': [0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000],
    'Cn_MVA': [210, 100, 100, 100, 100, 100, 250, 50, 100, 100, 25, 50, 55, 50, 100, 100, 100, 150, 60, 50],
    'Ce_MVA': [210, 100, 100, 100, 100, 100, 250, 50, 100, 100, 25, 50, 55, 50, 100, 100, 100, 150, 60, 50],
    'Ns': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
}

# Criação do DataFrame
df_circuitos = pd.DataFrame(dados_circuito)

# Definir um índice multi-nível (MultiIndex) para as barras de conexão (De, Para)
df_circuitos = df_circuitos.set_index(['De', 'Para'])

#print(df_circuitos)